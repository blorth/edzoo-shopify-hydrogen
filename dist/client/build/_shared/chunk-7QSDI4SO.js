import{n as P,o as m,p as g,q as L,t as C,v as _,z as w}from"https://cdn.shopify.com/oxygen-v2/31356/19637/40579/683287/build/_shared/chunk-P5AUVLLC.js";import{a as T}from"https://cdn.shopify.com/oxygen-v2/31356/19637/40579/683287/build/_shared/chunk-YHLO7HBR.js";import{d as F}from"https://cdn.shopify.com/oxygen-v2/31356/19637/40579/683287/build/_shared/chunk-2GVARK7B.js";var U=F(T(),1);function Q(a,e,t){let{validationBehavior:i,focus:c}=a;P(()=>{if(i==="native"&&t?.current){let r=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(r),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(z(t.current))}});let o=m(()=>{e.resetValidation()}),n=m(r=>{var d;e.displayValidation.isInvalid||e.commitValidation();let v=t==null||(d=t.current)===null||d===void 0?void 0:d.form;if(!r.defaultPrevented&&t&&v&&H(v)===t.current){var f;c?c():(f=t.current)===null||f===void 0||f.focus(),w("keyboard")}r.preventDefault()}),s=m(()=>{e.commitValidation()});(0,U.useEffect)(()=>{let r=t?.current;if(!r)return;let d=r.form;return r.addEventListener("invalid",n),r.addEventListener("change",s),d?.addEventListener("reset",o),()=>{r.removeEventListener("invalid",n),r.removeEventListener("change",s),d?.removeEventListener("reset",o)}},[t,n,s,o,i])}function q(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function z(a){return{isInvalid:!a.validity.valid,validationDetails:q(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function H(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}var l=F(T(),1),M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},O={...M,customError:!0,valid:!1},$={isInvalid:!1,validationDetails:M,validationErrors:[]},R=(0,l.createContext)({}),S="__formValidationState"+Date.now();function J(a){if(a[S]){let{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:c,commitValidation:o}=a[S];return{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:c,commitValidation:o}}return K(a)}function K(a){let{isInvalid:e,validationState:t,name:i,value:c,builtinValidation:o,validate:n,validationBehavior:s="aria"}=a;t&&(e||(e=t==="invalid"));let r=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:O}:null,d=(0,l.useMemo)(()=>B(W(n,c)),[n,c]);o?.validationDetails.valid&&(o=null);let v=(0,l.useContext)(R),f=(0,l.useMemo)(()=>i?Array.isArray(i)?i.flatMap(u=>A(v[u])):A(v[i]):[],[v,i]),[N,Y]=(0,l.useState)(v),[h,p]=(0,l.useState)(!1);v!==N&&(Y(v),p(!1));let V=(0,l.useMemo)(()=>B(h?[]:f),[h,f]),D=(0,l.useRef)($),[E,I]=(0,l.useState)($),b=(0,l.useRef)($),j=()=>{if(!k)return;y(!1);let u=d||o||D.current;x(u,b.current)||(b.current=u,I(u))},[k,y]=(0,l.useState)(!1);return(0,l.useEffect)(j),{realtimeValidation:r||V||d||o||$,displayValidation:s==="native"?r||V||E:r||V||d||o||E,updateValidation(u){s==="aria"&&!x(E,u)?I(u):D.current=u},resetValidation(){let u=$;x(u,b.current)||(b.current=u,I(u)),s==="native"&&y(!1),p(!0)},commitValidation(){s==="native"&&y(!0),p(!0)}}}function A(a){return a?Array.isArray(a)?a:[a]:[]}function W(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return A(t)}return[]}function B(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:O}:null}function x(a,e){return a===e?!0:a&&e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,i)=>t===e.validationErrors[i])&&Object.entries(a.validationDetails).every(([t,i])=>e.validationDetails[t]===i)}function G(a){let{id:e,label:t,"aria-labelledby":i,"aria-label":c,labelElementType:o="label"}=a;e=g(e);let n=g(),s={};t?(i=i?`${n} ${i}`:n,s={id:n,htmlFor:o==="label"?e:void 0}):!i&&!c&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let r=_({id:e,"aria-label":c,"aria-labelledby":i});return{labelProps:s,fieldProps:r}}function X(a){let{description:e,errorMessage:t,isInvalid:i,validationState:c}=a,{labelProps:o,fieldProps:n}=G(a),s=L([Boolean(e),Boolean(t),i,c]),r=L([Boolean(e),Boolean(t),i,c]);return n=C(n,{"aria-describedby":[s,r,a["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:o,fieldProps:n,descriptionProps:{id:s},errorMessageProps:{id:r}}}export{Q as a,J as b,X as c};

